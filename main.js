(()=>{"use strict";class e{constructor({data:e,handleCardClick:t},s){this._name=e.name,this._link=e.link,this._templateSelector=s,this._handleCardClick=t}_getTemplate(){return document.querySelector(this._templateSelector).content.cloneNode(!0)}_setTrashSignEventListener(){this._element.querySelector(".photo__delete").addEventListener("click",(function(e){e.target.parentElement.remove()}))}_setLikeButtonEventListener(){this._element.querySelector(".photo__like").addEventListener("click",(function(e){e.target.classList.toggle("photo__like_active")}))}_setImageClickEventListener(){this._photoImage=this._element.querySelector(".photo__image"),this._photoImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_setEventListeners(){this._setImageClickEventListener(),this._setLikeButtonEventListener(),this._setTrashSignEventListener()}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._photoImage.src=this._link,this._photoImage.alt=this._name,this._element.querySelector(".photo__description").textContent=this._name,this._element}}class t{constructor(e,t){this._config=e,this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._button=this._form.querySelector(this._config.submitButtonSelector)}_showError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.textContent="",t.classList.remove(this._config.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(e){e?(this._button.classList.remove(this._config.inactiveButtonClass),this._button.disabled=!1):(this._button.classList.add(this._config.inactiveButtonClass),this._button.disabled=!0)}_setEventListeners(){const e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState(!e._hasInvalidInput())}))}))}enableValidation(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(e){this._toggleButtonState(e),this._inputList.forEach((e=>{this._hideError(e)})),this._form.reset()}}class s{constructor(e){this._popupElement=document.querySelector(e)}open(){this.setEventListeners(),this._popupElement.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._handleOverlayClose),this._popupElement.removeEventListener("click",this._handleCloseByCloseBtn),this._popupElement.classList.remove("popup_opened")}setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("click",this._handleOverlayClose),this._popupElement.addEventListener("click",this._handleCloseByCloseBtn)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleOverlayClose=e=>{e.target.classList.contains("popup")&&this.close()};_handleCloseByCloseBtn=e=>{e.target.classList.contains("popup__close-btn")&&this.close()}}class n extends s{constructor(e,{formSubmit:t}){super(e),this._formSubmit=t,this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputList=this._popupElement.querySelectorAll(".popup__input")}setEventListeners(){this._popupForm.addEventListener("submit",this._handleFormSubmit),super.setEventListeners()}close(){this._popupForm.removeEventListener("submit",this._handleFormSubmit),this._popupForm.reset(),super.close()}_getInputValues(){return this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}_handleFormSubmit=e=>{e.preventDefault(),this._formSubmit(this._getInputValues())}}const o=document.querySelector(".profile__edit-btn"),i=document.querySelector(".profile__add-btn"),r=document.querySelector(".popup_type_edit-profile"),p=r.querySelector(".popup__form"),l=r.querySelector("#popup__input_content_name"),a=r.querySelector("#popup__input_content_activity"),c=(r.querySelector(".popup__save-btn"),document.querySelector(".popup_type_add-photo").querySelector(".popup__form")),_=(c.querySelector(".popup__save-btn"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",closeButtonSelector:".popup__close-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),u=new class{constructor(e,t){this._nameField=document.querySelector(e),this._activityField=document.querySelector(t)}getUserInfo(){return{name:this._nameField.textContent,activity:this._activityField.textContent}}setUserInfo(e){this._nameField.textContent=e.name,this._activityField.textContent=e.activity}}(".profile__name",".profile__activity"),h=new n(".popup_type_edit-profile",{formSubmit:e=>{u.setUserInfo(e),h.close()}}),d=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__photo"),this._popupDescription=this._popupElement.querySelector(".popup__photo-description")}open(e,t){this._popupDescription.textContent=e,this._popupImage.src=t,this._popupImage.alt=e,super.open()}close(){super.close(),this._popupImage.src="",this._popupDescription.textContent=""}}(".popup_type_view-photo"),m=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=y(e);m.addItem(t)}},".photos");m.renderItems();const v=new n(".popup_type_add-photo",{formSubmit:e=>{const t=y(e);m.addItem(t),v.close()}});function y(t){return new e({data:t,handleCardClick:(e,t)=>{d.open(e,t)}},"#photo-template").generateCard()}const f=new t(_,p);f.enableValidation();const E=new t(_,c);E.enableValidation(),o.addEventListener("click",(()=>{f.resetValidation(!0),l.value=u.getUserInfo().name,a.value=u.getUserInfo().activity,h.open()})),i.addEventListener("click",(()=>{E.resetValidation(!1),v.open()}))})();